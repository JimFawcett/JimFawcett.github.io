<!DOCTYPE html>
<html id="top">
  <head>
    <meta http-equiv="content-type" content="text/html;charset=UTF-8" />
    <meta name="keywords" content="Rust, Introduction" />
    <meta name="Author" content="Jim Fawcett" />
    <meta name="Author" content="James Fawcett" />
    <title>Basic DIP</title>
    <link rel="stylesheet" href="../BuildOn/css/Styles_Basic.css" />
    <link rel="stylesheet" href="../BuildOn/css/Styles_Structure.css" />
    <link rel="stylesheet" href="css/IaP_Styles.css" />
    <!--<link rel="stylesheet" href="css/BiteStyles.css" />-->
    <script src="js/IaP_Scripts.js"></script>
    <!--<script src="js/BiteScripts.js"></script>-->
    <script src="js/ScriptsWebComponents.js"></script>
    <link rel="stylesheet" href="css/StylesWebComponents.css" />
    <script>
      function hide(elem) {
        var elm = document.getElementById(elem);
        elm.style.display = "none";
      }
    </script>
    <style>
      #github .large {
        font-size: 1.25rem;
      }
    </style>
  </head>
  <body id="github" onload="initBites()">
    <div class="top-banner" onclick="storyMenu.getHelp()">
      <span id="hctr">Idioms and Patterns Story</span>
      <div style="position:relative; left:calc(100vw - 15rem);">
        <span class="top-center">Basic DIP</span>
        <!-- <a class="top-right" href="../../RustBiteByByte.html">RustBiteByByte.html</a> -->
      </div>
    </div>
    <next-prev>
      <a href="../../index.html" style="color:#fefefa;">Home</a>&nbsp;
      <a id="repo" href="../../IdiomsAndPatterns.html">Repo</a> 
      <a id="prev" href="IaP_Objects.html">prev</a> 
      <a id="next" href="IaP_GenericDIP.html">next</a>
    </next-prev>

    <toc-b id="toc">
      <div id="bottom-menu" style="display:flex; flex-direction:row">
        <!--<a href="Javascript:;" onclick="storyMenu.toggleTOC()" style="color:#fefefa;">E</a>&nbsp;
        <a href="Javascript:;" onclick="storyMenu.closeTOC()" style="color:#fefefa;">C</a>&nbsp;
        <a href="Javascript:;" onclick="storyMenu.sects()" style="color: #fefefa; ">Sects</a>&nbsp;
        <a href="Javascript:;" onclick="storyMenu.chaps()" style="color:#fefefa;">Bites</a>&nbsp;-->
      </div>
      <!-- <up-b id="chaps" onmouseout="storyMenu.chaps()"> -->
      <up-b id="chaps">
        <!--<a href="ObjectModels.html">Object Models</a><br />-->
        <!--<a href="Tooling.html">Tooling</a><br />
        <a href="IaP_Hello.html">Hello World</a><br />
        <a href="IaP_Objects.html">Hello Objects</a><br />
        <a href="IaP_Data.html">Manage Data</a><br />
        <a href="IaP_Libs.html">Static Libs</a><br />
        <a href="javascript:;"></a><br />-->
      </up-b>
      <rt-b id="sects">
        <a href="#top">Top</a>, <a href="#bottom">Bottom</a>
      </rt-b>
    </toc-b>
    <div id="hlp" style="display:none;">
      <!--<table>
        <tr>
          <td style="padding-right:5px;">Esc</td>
          <td>toggle menus</td>
        </tr>
        <tr>
          <td>C</td>
          <td>close menus</td>
        </tr>
        <tr>
          <td>R</td><td>Refresh</td>
        </tr>
        <tr>
          <td>N</td><td>Next Bite</td>
        </tr>
        <tr>
          <td>P</td><td>Prev Bite</td>
        </tr>
        <tr>
          <td>T</td><td>scroll to top</td>
        </tr>
        <tr>
          <td>B</td><td>scroll to bottom</td>
        </tr>
        <tr>
          <td>H</td><td>Help</td>
        </tr>
      </table>-->
    </div>
    <div style="padding:2rem 2rem 5rem 2rem;">
    <h1>Basic DIP</h1>
    <h3 style="margin-left:3em; margin-top:0em; font-weight:normal;">
      Minimal demonstration of Dependency Inversion Principle (DIP) 
    </h3>
    <hr class="spread" />
    <t-b>
      The Dependency Inversion Prinicple states:
      <div class="indent pad5">
        High-level components should not depend on low-level components.  They should both depend on
        abstractions.
      </div>
      The principle tells us that a software component should depend on abstract interfaces of components it uses
      instead of directly binding to the used compenents implementations. To completely sever the using component 
      from a used component, the abstract interface must provide a factory function that removes user creational
      dependencies.
    </t-b>
    <t-b>
      The code below shows how to do that.
    </t-b>
    <div style="height:1rem;"></div>
    <defn-outerBlock style="width:calc(100vw - 6rem);">
      <defn-block id="cpp">
        <defn-head class="darkBlue">
          C++
          <span class="right darkBlue smallpad cursor" onclick="storyMenu.hide('cpp')">hide</span>
        </defn-head>
        <defn-code class="lightBlue">
To appear eventually
        </defn-code>
      </defn-block>
      <defn-block>
        <defn-head class="darkRust">
          Rust
          <span class="right darkRust smallpad cursor" onclick="location.reload()">unhide</span>
        </defn-head>
        <defn-code class="lightRust">
///////////////////////////////
// basic_dip::main.rs        //
//                           //
// Jim Fawcett, 19 Jan 2021  //
///////////////////////////////
/*
    Dependency Inversion Principle:
      "High level modules should not depend on
       low level modules.  Both should depend
       on abstractions."

    This demonstration builds a basic demo with
    self annunciating low level components.    
      - High level part: Demo&lt;T&gt;
      - Low level parts: First, Second
      - Abstraction: 
        - trait Say

    The definitons of First and Second could be
    changed in any way that is compatible with 
    trait Say without affecting compilation of
    Demo&lt;T&gt;.
*/


#![allow(dead_code)]

/*-------------------------------------------
  trait - very like C# interface
*/
pub trait Say {
    fn new() -&gt; Self;  // factory function
    fn set_id(&amp;mut self, id: u8);
    fn get_id(&amp;self) -&gt; u8;
    fn say(&amp;self);
}
/*-------------------------------------------
  First "low-level" component
*/
pub struct First {
    id: u8
}
/*-------------------------------------------
  implementing trait - very like inheritance
*/
impl Say for First {
    fn new() -&gt; First {
        First {
            id: 0
        }
    }
    fn set_id(&amp;mut self, id: u8) {
        self.id = id;
    }
    fn get_id(&amp;self) -&gt; u8 {
        self.id
    }
    fn say(&amp;self) {
        print!(
          "\n  First here with id = {:?}",
          self.id
        );
    }
}
/*-------------------------------------------
  Second "low-level" component
*/
pub struct Second {
    id: u8
}
impl Say for Second {
    fn new() -&gt; Second {
        Second {
            id: 0
        }
    }
    fn set_id(&amp;mut self, id: u8) {
        self.id = id;
    }
    fn get_id(&amp;self) -&gt; u8 {
        self.id
    }
    fn say(&amp;self) {
        print!(
          "\n  Second here with id = {:?}",
          self.id
        );
    }
}
/*-------------------------------------------
  A "high-level" component
*/
struct Demo&lt;T&gt; where T: Say {
    my_say: T
}
/*-------------------------------------------
  Implementing Demo methods
*/
impl&lt;T&gt; Demo&lt;T&gt; where T: Say {
    fn new() -&gt; Demo&lt;T&gt; {
        Demo {
            /*-- use factory function */
            my_say: T::new()
        }
    }
    fn set_id(&amp;mut self, id:u8) {
        /*-- use trait method --*/
        self.my_say.set_id(id);
    }
    fn get_id(&amp;self) -&gt; u8 {
        /*-- use trait method --*/
        self.my_say.get_id()
    }
    fn say_it(&amp;self) {
        /*-- use trait method --*/
        self.my_say.say();
    }
}
/*-------------------------------------------
  Using DIP structure
*/
fn main() {
    print!("\n  -- basic_dip demo --\n");

    let mut first = Demo::&lt;First&gt;::new();
    first.set_id(1);
    first.say_it();
    let mut second = Demo::&lt;Second&gt;::new();
    second.set_id(2);
    second.say_it();
    println!("\n\n  That's all Folks!\n\n");
}
        </defn-code>
        <defn-head class="darkRust">Output</defn-head>
        <defn-code class="lightRust">
C:\...\DepInvPrinciple\BasicDip>     
cargo run -q

  -- basic_dip demo --

  First here with id = 1
  Second here with id = 2

  That's all Folks!

        </defn-code>
      </defn-block>
      <defn-block id="csh">
        <defn-head class="darkBlack">
          C#
          <span class="right darkBlack smallpad cursor" onclick="storyMenu.hide('csh')">hide</span>
        </defn-head>
        <defn-code class="lightBlack">
To appear eventually
        </defn-code>
      </defn-block>
    </defn-outerBlock>

    <div style="height:2em;"></div>

      <h3 style="margin-top:0px;">4. Epilogue</h3>
      <t-b>
        The following pages provide sequences of code examples for idioms and principles in each of the three languages 
        cited here, e.g. C#, C++, and Rust.  Object model differences will often be pointed out in comments within the 
        code blocks.
      </t-b>
    </div>
      <s-1em></s-1em>
      <a id="bottom"></a>
  </body>
</html>
