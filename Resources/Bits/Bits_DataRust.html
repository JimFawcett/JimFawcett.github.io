<!DOCTYPE html>
<html>
<!--
  Bits_DataRust.html
-->
<head>
  <title>Bits_Data Rust</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="css/StylesPhoto.css" />
  <link rel="stylesheet" href="css/StylesSizerComp.css" />
  <!-- PageFrame infrastructure -->
  <link rel="stylesheet" href="css/StylesPageFrameDefaults.css" />
  <link rel="stylesheet" href="css/StylesPageFrameStructure.css" />
  <link rel="stylesheet" href="css/StylesPageFrameMenus.css" />
  <link rel="stylesheet" href="css/StylesPageFrameThemeDefault.css" />
  <link rel="stylesheet" href="css/StylesWebComponents.css" />
  <script src="js/ScriptsWebComponents.js"></script>
  <script src="js/ScriptsPageFrame.js"></script>
  <script src="js/ScriptsPageFramePagesBits.js"></script>
  <script src="js/ScriptsPageFrameKeyboard.js"></script>
  <!--<script src="js/ScriptsPageFrameNewRadioButtons.js"></script>-->
  <style>
    #github .note {
      border: 1px solid var(--dark);
      padding:0.75em 1.5em;
      margin-top:1.25em;
      margin-bottom:1.25em;
      background-color: var(--light);
      color: var(--dark);
      max-width:50em;
    }
    #github h2 {
      margin-top: 0.75em;
    }
    #github #pagetitle {
      border:2px double var(--dark);
    }
    #github form {
      border:none;
      padding:0.5em 1em;
    }
    #github form span {
      padding:0em 0.5em;
    }
    #github code-container {
      display: flex;
      position:relative;
      width:calc(100%);
      flex-direction: row;
      justify-content: space-between;
      /*border-top: 1px solid var(--dark);*/
    }
    #github code-banner {
      display: block;
      border: 2px solid var(--dark);
      border-top:none;
      border-bottom:none;
      padding: 0.25em 1em;
      font-family: 'Comic Sans MS', Tahoma;
      width: calc(100% + 0.5em);
      background-color: var(--atten);
    }
    #github code-display {
      display: block;
      border: 2px solid var(--dark);
      white-space: pre;
      padding: 0.75em 1em;
      font-family: Consolas, monospace;
      font-size:0.9em;
      width: calc(50% - 0.5em);
      overflow-x: auto;
      /*height:20em;*/
    }
    #github label {
      margin-right:1em;
    }
    #github fieldset {
      border:none;
    }
    #github #exeRight, #exeLeft {
      padding: 0.05em 0.5em;
      font-family: 'Comic Sans MS', Tahoma;
    }
    #github #hideLeft, #hideRight {
      padding: 0.05em 0.5em;
      font-family: 'Comic Sans MS', Tahoma;
    }
    #github .hide {
      display:none;
    }
    body {
      position:relative;
    }
    #github table.showcode {
      table-layout:fixed;
      width:calc(100% + 4em);
      margin-left:-2em;
    }
    #github th.leftblock {
      border: 2px solid var(--dark);
      /*border: 1px solid red;*/
      background-color: var(--menu);
      width: calc(50% - 0.5em);
      overflow-x: auto;
    }

    #github th.rightblock {
      border: 2px solid var(--dark);
      background-color: var(--menu);
      width: calc(50% - 0.5em);
      overflow-x: auto;
    }

    #github th.centerblock {
      border: none;
      padding: 0em;
      width:1em;
    }
    #github td.leftblock {
      border: 2px solid var(--dark);
      width: calc(50% - 0.5em);
      overflow-x: auto;
      background-color: #222233;
      color: #ffffbb;
    }

    #github td.leftblock summary {
      border:1px solid #ffffbb;
    }

    #github td.rightblock {
      border: 2px solid var(--dark);
      width: calc(50% - 0.5em) !important;
      overflow-x: auto;
      background-color: #222233;
      color: #ffffbb;
    }

    #github td.rightblock summary {
      border: 1px solid #ffffbb;
    }

    #github td.centerblock {
      border: none;
      padding: 0em;
    }
    #github pre {
      overflow-x: auto !important;
    }
    #github #left1 {
      /*height:45em;*/
      max-height: calc(100vh - 10em);
      overflow-y: auto;
    }

    #github #right1 {
      max-height: calc(100vh - 10em);
      overflow-y: auto;
    }
    #github #left2 {
      /*height:45em;*/
      max-height: calc(100vh - 7em);
      overflow-y: auto;
    }

    #github #right2 {
      max-height: calc(100vh - 7em);
      overflow-y: auto;
    }
    #github #left3 {
      max-height: calc(100vh - 7em);
      overflow-y: auto;
    }

    #github #right3 {
      max-height: calc(100vh - 7em);
      overflow-y: auto;
    }
    #github .mover {
      width:2em;
      padding: 0.05em;
      position:relative;
      right:-1.5em;
      top:0.6em;
    }
    #github #ruler {

      width:calc(50% - 1.5em);
      height:0.001em;
      margin:-0.45em 0em;
    }
    #github .btns {
      width:3em;
      border:none;
    }
    #github .codeSnap {
      font-family: Consolas, Courier New, Courier, monospace, sans-serif;
      font-size: small;
      font-weight: bold;
      background-color: #eee;
      padding: 10px;
    }
    #github .remotebutton {
      padding:0.25em 0.5em;
    }
    #github .rightPanelLinks {
      position: fixed;
      right: 0.0em;
      top: 15em;
      z-index: 100;
      background: var(--light);
      padding: 0.75em 0.25em;
      border: 1px solid var(--dark);
    }

    #github div.rightPanelLinks a {
      display: block;
      height: 1.5em;
      padding: 0em 0.25em;
    }
    #github hr.spread {
      margin:0.75em 0em;
    }
  </style>
  <script>
    function saveScroll() {
      let main = document.querySelector("main");
      localStorage.setItem("DataRust", main.scrollTop);
    }
    function getScroll() {
      let scroll = localStorage.getItem("DataRust");
      if (scroll) {
        scrollTop = parseInt(scroll, 10);
        let main = document.querySelector("main");
        main.scrollTop = scrollTop;
      }
    }
  </script>

  <script>
    function remote() {
      window.open('https://play.rust-lang.org/?version=stable&mode=debug&edition=2021&gist=502fba0c378b9c9e4202541c7d0751fa', '_blank');
    }
  </script>
</head>
<body id="github" onload="initialize()" onbeforeunload="saveScroll()">

  <a id="Next" href="Bits_ObjectsRust.html">Next</a>
  <a id="Prev" href="Bits_HelloRust.html">Prev</a>

  <page-frame>
    <frame-header>
      <nav id="navbar"></nav>
    </frame-header>
    <main>
      <div id="about">about</div>
      <div id="page">Bits Data Rust</div>
      <div id="modified">04/29/2023</div>
      <div id="hlp"></div>
      <a id="top"></a>
      <content id="content">
        <div class="rightPanelLinks">
          <a href="Bits_DataCpp.html">C++</a>
          <a class="darkItem" href="Bits_DataRust.html">Rust</a>
          <a href="Bits_DataCSharp.html">C#</a>
          <a href="Bits_DataPython.html">Python</a>
          <a href="Bits_DataJs.html">JvScrpt</a>
        </div>
        <header>
          <a target="_blank" class="repoLink" href="https://github.com/JimFawcett/Bits">Bits Repo Code</a>
          <a target="_blank" class="repoLink" href="../../BitsRepo.html" style="margin-right:7.5em;">Bits Repo Docs</a>
          <hgroup id="pagetitle">
            <h1 id="title">Bits_Data Rust</h1>
            <h3 id="subtitle" class="indent">
              code, output, and build for Rust on Windows, macOS, and Linux
            </h3>
          </hgroup>
        </header>
        <t-b>
          These pages support comparison of fragments of code in several different
          languages, much as you might compare a sentence of English with one in Spanish to help you learn
          Spanish.
          </t-b>
          <t-b style="border:1px solid maroon; padding:0.25em 1em 0.5em 1em;">
            <h4 style="margin:0em 0em 0.25em 0em;">Synopsis:</h4>
            This page demonstrates simple uses of the most important Rust types.
            The purpose is to quickly acquire some familiarity with types and their uses.
            <hr class="spread" />
            <ul>
              <li>
                Rust provides two kinds of types: copy and move.
              </li>
              <li>
                Primitive types and aggregates of primitive types are copy.  Assignment and
                pass-by-value copies the source&apos;s value to the destination.
              </li>
              <li>
                All other types are move. Assignment and pass-by-value moves the source&apos;s
                resources to the destination. This is a transfer of ownership and
                makes the source invalid. Attempting to use a &quot;moved&quot; variable is a
                compile error.
              </li>
              <li>
                Most move types provide clone operations that support making copies, but using
                code must explicitly call clone().
              </li>
              <li>
                Rust supports making fixed references to either copy or move types. These may
                refer to instances in stack memory or in the native heap.
              </li>
              <li>
                Rust references are constrained by Rust ownership rules to support memory
                and data race safety by construction.
              </li>
              <li>
                Here we begin to see significant differences between the languages, especially
                when comparing statically typed languages like C++, Rust, and C#, with dynamically typed
                languages like Python and JavaScript.
              </li>
            </ul>
            <div style="height:0.25em;"></div>
          </t-b>
        <div style="height:0.25em;"></div>
        <h3 id="code">1.0 CodeSnaps</h3>
        <input type="button" value="RemoteExecute" class="remotebutton" onclick="remote()" />
        <div style="display:flex; flex-direction:column;">
          <h4 id="source">Source Code</h4>
          <pre class="codeSnap">
#![allow(unused_mut)]
#![allow(clippy::approx_constant)]

/* rust_hello_data::main.rs */
/*
  Static Data Types:
    bool, char
    i8, i16, i32, i64, i128, isize
    u8, u16, u32, u64, u128, usize
    f32, f64
    (), reference
    array, tuple, struct, enum
  Qualifiers:
    mutable, const

  Library Types:
    std::String, std::Vec&lt;T&gt;, std::HashMap&lt;K,V&gt;,
    std::VecDeque&lt;T&gt;, std::BTreeSet&lt;T&gt;, std::BTreeMap&lt;K,V&gt;,
    std::LinkedList&lt;T&gt;, std::BinaryHeap&lt;T&gt;

  Operations:
    Primitive types can all be copied.
    Most library and user-defined types can be moved,
    cloned, but only aggregates with all copyable members
    can be copied.

  Processing:
    All types are static, operations run as native code,
    and no garbage collection is needed. Resources are
    returned at end of declr scope.
*/
use std::fmt::Debug;

fn main() {
    println!(
        &quot;&#92;n Demonstrate Rust types&#92;n&#92;
       ------------------------&quot;
    );
    /*
      Primitive data types: i32, f64, ... occupy contiguous
      regions of memory, so they satisfy the copy trait.

      Library types like String have a control block in stack
      and data in heap. So they do not satisfy the copy trait.

      A move type can be cloned, but that requires an explicit
      call to clone(). Otherwise, assignment and pass by value
      result in move which transfers ownership of heap
      resources and invalidates the moved instance.

      Any attempt to use a moved instance results in compile
      failure.
    */

    /*-- these values live in stack frame --*/

    println!(&quot;&#92;n  -- initialize on stack from literals --&quot;);
    let t1: i32 = 42;
    show_type(t1, &quot;t1&quot;);

    let t1a = 42i64;    // alternate declaration style
    show_type(t1a, &quot;t1a&quot;);
    /*
      Below is not type redefinition, it is shadowing,
      e.g., a new variable that hides the older t1a.
    */
    let mut t1a: f64 = 42.0;  // will change value later
    show_type(t1a, &quot;t1a&quot;);

    /*-- create mutable reference --*/

    let t1b: &mut f64 = &mut t1a;  // requires t1a to be mutable
    *t1b = 84.0;
    show_type(t1b, &quot;t1b&quot;);

    /*-- values live in heap when wrapped with box --*/

    println!(&quot;&#92;n  -- initialize on heap --&quot;);

    // 3.14159f64 below is a value specified to be f64
    let t2 = Box::new(3.14159f64);
    show_type(*t2, &quot;*t2&quot;);
    show_type(t2, &quot;t2&quot;);    // moves t2, use t2.clone() to avoid move
    // print!(&quot;{}&quot;, &t2.to_string());  // error - t2 moved

    /*-- Box releases its heap storage when it goes out of scope --*/

    println!(&quot;&#92;n  -- size_of measures size of handle to heap element --&quot;);

    let s1 = std::mem::size_of::&lt;Box&lt;i8&gt;&gt;();
    let s2 = std::mem::size_of::&lt;Box&lt;i64&gt;&gt;();
    println!(&quot;&#92;nsize_of::&lt;Box&lt;i8&gt;&gt;() = {s1}&quot;);
    println!(&quot;size_of::&lt;Box&lt;i64&gt;&gt;() = {s2}&quot;);

    print!(&quot;&#92;n  -- String is collection of utf8 chars --&#92;n&quot;);
    /*--
      Each utf8 character may take from 1 to 4 bytes. The first
      byte in a char sequence has bits that describe the size of
      the character. utf8 can represent many more characters than
      ASCII, so Rust strings can contain SanSkrit, Kangi, Arabic,
      and emojis, as well as English.

      String control block lives on stack, char data live in heap.
      Passing by value or assignment transfers ownership from
      source to destination.  That is a move.
    --*/
    let t3: String = String::from(&quot;a string&quot;); // temp moved
    show_type(&t3, &quot;t3&quot;);

    println!(&quot;&#92;n  -- use clone to avoid src move --&quot;);

    show_type(t3.clone(), &quot;t3.clone()&quot;); // moves t3s clone, not t3

    let t4 = &t3; // reference to still valid t3
    show_type(t4, &quot;t4&quot;);

    println!(&quot;&#92;n  -- array of copy type elements is copy --&quot;);

    let t5 = [1, 2, 3, 4, 5]; // copy type
    show_type(t5, &quot;t5&quot;);

    let mut txt = String::from(&quot;&#92;nt5 was copied into show_type(...)&quot;);
    txt += &quot;, see:&#92;nt5 = &quot;;
    println!(&quot;{txt}{t5:?} is still valid&quot;);

    println!(&quot;&#92;n  -- vec is like an extendable array --&quot;);

    let mut v1 = Vec::&lt;i32&gt;::new();
    v1.push(1);
    v1.push(-1);
    v1.insert(1, 4);
    show_type(v1, &quot;&#92;&quot;v1&#92;&quot;&quot;);  // v1 moved

    let v2 = vec![42, 84, 126];
    show_type(&v2, &quot;&v2&quot;);    // v2 not moved, passed reference
                              // size of &v2 is size of a pointer
    show_type(v2, &quot;v2&quot;);      // v2 moved, can't be used again

    println!(&quot;&#92;n&#92;nThat's all Folks!!&#92;n&#92;n&quot;);
}
/*
  show_type is generic function with Debug bound.
  Using format &quot;{:?}&quot; requires Debug.
  - mem::size_of::&lt;T&gt; measures size of T in stackframe.
    It does not measure size of resources on heap.
*/
fn show_type&lt;T: Debug&gt;(t: T, nm: &str) {
  let typename = std::any::type_name::&lt;T&gt;();
  println!(&quot;&#92;n{nm}, {typename}&quot;);
  println!(
    &quot;value: {:?}, size: {}&quot;,
    t, std::mem::size_of::&lt;T&gt;()
  );
}
</pre>
          <h4 id="out">Output</h4>
          <pre class="codeSnap">
 Demonstrate Rust types
------------------------

  -- initialize on stack from literals --

t1, i32
value: 42, size: 4

t1a, i64
value: 42, size: 8

t1a, f64
value: 42.0, size: 8

t1b, &mut f64
value: 84.0, size: 8

  -- initialize on heap --

*t2, f64
value: 3.14159, size: 8

t2, alloc::boxed::Box&lt;f64&gt;
value: 3.14159, size: 8

  -- size_of measures size of handle to heap element --

size_of::&lt;Box&lt;i8&gt;&gt;() = 8
size_of::&lt;Box&lt;i64&gt;&gt;() = 8

  -- use clone to avoid src move --

t3.clone(), alloc::string::String
value: &quot;Hello Data&quot;, size: 24

t4, &alloc::string::String
value: &quot;Hello Data&quot;, size: 8

  -- array of copy type elements is copy --

t5, [i32; 5]
value: [1, 2, 3, 4, 5], size: 20

t5 was copied into show_type(...), see:
t5 = [1, 2, 3, 4, 5] is still valid

  -- vec is like an extendable array --

&quot;v1&quot;, alloc::vec::Vec&lt;i32&gt;
value: [1, 4, -1], size: 24

&v2, &alloc::vec::Vec&lt;i32&gt;
value: [42, 84, 126], size: 8


That's all Folks!!

          </pre>
          <h4 id="build">Build</h4>
          <pre class="codeSnap">
C:&#92;github&#92;JimFawcett&#92;Bits&#92;Rust&#92;rust_hello_data
&gt; cargo run
   Compiling rust_hello_data v0.1.0 (C:&#92;github&#92;JimFawcett&#92;Bits&#92;Rust&#92;rust_hello_data)
    Finished dev [unoptimized + debuginfo] target(s) in 0.32s
     Running `target&#92;debug&#92;rust_hello_data.exe`

          </pre>
        </div>
        <h3 id="ide">2.0 VS Code View</h3>
        <t-b>
          The code for this demo is available in 
          <a target="_blank" href="https://github.com/JimFawcett/Bits">github.com/JimFawcett/Bits</a>. If you click on
          the Code dropdown you can clone the repository of all code for these demos to your local drive.
          Then, it is easy to bring up any example, in any of the languages, in VS Code.
        </t-b>
        <t-b>
          Here, we do that for Rust\rust_hello_data.
        </t-b>
        <photosizer-block src="pictures/VS_Code_Rust_Data.JPG" width="800" class="photoSizerBlock left"
          style="overflow-x:auto;"
        >
          <span style="font-family:'Comic Sans MS';">Figure 1. VS Code IDE</span>
        </photosizer-block>
        <photosizer-block src="pictures/LaunchJSON_Rust_Data.JPG" width="700" class="photoSizerBlock left"
          style="overflow-x:auto;"
        >
          <span style="font-family:'Comic Sans MS';">Figure 2. Launch.JSON</span>
        </photosizer-block>
        <!--<photosizer-block src="pictures/VS_Code_Cpp_Plugins.jpg" width="700" class="photoSizerBlock left">
          <span style="font-family:'Comic Sans MS';">Figure 3. C++ Plugins</span>
        </photosizer-block>-->

        <div style="height:0.75em;" class="clear"></div>
        <h3 id="refs">3.0 References</h3>
        <table class="indent">
          <tr>
            <th class="darkItem">Reference</th><th class="darkItem">Description</th>
          </tr>
          <tr>
            <td>
              <a target="_blank" href="../../RustStoryRepo.html">Rust Story</a>
            </td>
            <td>
              E-book with seven chapters covering most of intermediate Rust
            </td>
          </tr>
          <tr>
            <td>
              <a target="_blank" href="../RustBites/RustBites_Intro.html">Rust Bites</a>
            </td>
            <td>
              Relatively short feature discussions
            </td>
          </tr>
        </table>
        <div style="height:10em;"></div>
      </content>
      <a id="bottom"></a>
      <page-TOC id="pages" style="display:none;">
      </page-TOC>
      <page-sections id="sections" style="display:flex;">
        <menu-elem style="width:0.0em">&nbsp;</menu-elem>
        <menu-elem class="secElem"><a href="#bottom">bottom</a></menu-elem>
        <menu-elem class="secElem"><a href="#refs">refs</a></menu-elem>
        <menu-elem class="secElem"><a href="#ide">VS Code</a></menu-elem>
        <menu-elem class="secElem"><a href="#build">bld</a></menu-elem>
        <menu-elem class="secElem"><a href="#out">out</a></menu-elem>
        <menu-elem class="secElem"><a href="#source">src</a></menu-elem>
        <menu-elem class="secElem"><a href="#code">codeSnaps</a></menu-elem>
        <menu-elem class="secElem"><a href="#top">top</a></menu-elem>
      </page-sections>
    </main>
    <frame-footer>
      <menu-item style="width:1.0em;">&nbsp;</menu-item>
      <menu-elem id="nextLink2" onclick="bottomMenu.next()">Next</menu-elem>
      <menu-elem id="prevLink2" onclick="bottomMenu.prev()">Prev</menu-elem>
      <menu-elem id="pgbtn" onclick="bottomMenu.pages()">Pages</menu-elem>
      <menu-elem onclick="bottomMenu.sections()">Sections</menu-elem>
      <menu-elem onclick="bottomMenu.about()">About</menu-elem>
      <menu-elem id="kysbtn" onclick="storyHlpMenu.keys()">Keys</menu-elem>
      <menu-elem style="margin-right:5em">
        <span id="loc" style="display:inline-block; font-weight:normal"></span>
      </menu-elem>
    </frame-footer>
  </page-frame>
  <script>
    let loc = document.getElementById("loc");
    let fn = window.location.href.split(/\/|\\/).pop();
    loc.innerHTML = fn;
  </script>
  <script>
    //localStorage.clear();
    getScroll();
  </script>
</body>
</html>